// Generated by CoffeeScript 1.6.3
var app,board,hashAppend,hashList,hashRemove,hashToggle,updateImages,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};board=document.querySelector(".board");updateImages=function(){return setTimeout(function(){var e,t,n,r,i;r=[].slice.call(document.getElementsByClassName("js-img"),0);i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.getBoundingClientRect().top<window.innerHeight*2?e.style.backgroundImage?i.push(void 0):i.push(e.style.backgroundImage="url("+e.dataset.src+")"):i.push(void 0)}return i},0)};board.addEventListener("scroll",updateImages);board.addEventListener("touchmove",updateImages);window.addEventListener("resize",updateImages);hashList=function(){var e,t,n,r,i;r=window.location.hash.substring(1).split("-");i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e&&i.push(e)}return i};hashToggle=function(e){return __indexOf.call(hashList(),e)>=0?hashRemove(e):hashAppend(e)};hashRemove=function(e){return window.location.hash=hashList().filter(function(t){return t!==e}).join("-")};hashAppend=function(e){if(__indexOf.call(hashList(),e)<0)return window.location.hash=hashList().concat(e).sort(function(e,t){return parseInt(e,16)-parseInt(t,16)}).join("-")};window.addEventListener("hashchange",function(){return localStorage.hash=window.location.hash.substring(1)});localStorage["hash"]!=null&&(window.location.hash=localStorage.hash);app=angular.module("aboard",[]);app.filter("mature",function(){return function(e){return __indexOf.call(e.split(" "),"mature")>=0?"*":""}});app.controller("main",["$scope","$http","$compile",function(e,t,n){var r;e.feeds=[];e.items=[];e.current=!1;r=t.jsonp("http://spreadsheets.google.com/feeds/list/0AnqTdoRZw_IRdHctX2RyQncwRVA0eWZsSERsdUxOT0E/od6/public/basic?alt=json-in-script&callback=JSON_CALLBACK");r.success(function(t){var n,r,i,s,o,u,a,f,l,c,h,p;r=function(){var e,r,i,s;i=t.feed.entry;s=[];for(e=0,r=i.length;e<r;e++){n=i[e];s.push(JSON.parse('{"id":"'+n.title.$t+'", '+n.content.$t.replace(/([a-z]+)[\s]*\:[\s]*([^,]+)/g,'"$1":"$2"')+"}"))}return s}();r=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++){n=r[e];n.online!=="0"&&i.push(n)}return i}();if(window.location.hash.substring(1))for(s=0,a=r.length;s<a;s++){n=r[s];n.status=(c=n.id,__indexOf.call(hashList(),c)>=0)}else for(o=0,f=r.length;o<f;o++){n=r[o];if(n==null)continue;n.status=n.status==="1"?!0:!1;n.status&&hashAppend(n.id)}e.feeds=r;h=hashList();p=[];for(u=0,l=h.length;u<l;u++){i=h[u];p.push(e.loadItems(i))}return p});e.loadItems=function(n,i){var s,o;i==null&&(i=!1);s=function(){var t,r,i,s;i=e.feeds;s=[];for(t=0,r=i.length;t<r;t++){o=i[t];o.id===n&&s.push(o)}return s}().pop();r=t.jsonp("https://ajax.googleapis.com/ajax/services/feed/load?v=2.0&callback=JSON_CALLBACK&num=100&q="+encodeURIComponent(s.feed));r.error(function(){return hashRemove(s.id)});return r.success(function(t){var r,u,a;a=t.responseData.feed.entries;for(r=0,u=a.length;r<u;r++){o=a[r];e.items.push({feed:s.id,source:s.url.replace(/^http(?:s)?\:\/\/([^\/]+)\/*$/,"$1"),title:o.title,author:o.author,date:new Date(o.publishedDate),url:o.link,image:o.content.match(/<img[^<>]+src=[\"\']([^\"\']+)[\"\'][^<>]*>/)[1]})}updateImages();if(i)return e.setCurrent(n)})};e.removeItems=function(t){e.items=e.items.filter(function(e){return e.feed!==t});return e.resetCurrent()};e.resetCurrent=function(){return e.setCurrent(!1)};e.setCurrent=function(t){var n,r,i;if(e.current=t){i=[document.querySelector("#feed-"+t),document.querySelector(".nav-feeds")],n=i[0],r=i[1];r.scrollLeft=n.offsetLeft-r.offsetLeft-r.offsetWidth/2+n.offsetWidth/2}board.scrollTop=0;updateImages();if(!e.$$phase)return e.$apply()};return window.addEventListener("keydown",function(t){var n;switch(t.which){case 37:n=e.current?document.querySelector("#feed-"+e.current).previousSibling:document.querySelector(".nav-feed:last-child");break;case 39:n=e.current?document.querySelector("#feed-"+e.current).nextSibling:document.querySelector(".nav-feed:first-child")}if(n)return n.getAttribute?e.setCurrent(n.getAttribute("id").replace("feed-","")):e.resetCurrent()})}]);app.controller("feed",["$scope","$http",function(e,t){e.showItems=function(){return e.setCurrent(e.feed.id)};return e.toggleFeed=function(){e.feed.status=!e.feed.status;hashToggle(e.feed.id);return e.feed.status?e.loadItems(e.feed.id,!0):e.removeItems(e.feed.id)}}]);(function(){var e,t,n,r,i;t=document.getElementById("logo");i=document.getElementById("wave");e=document.getElementById("boat");n=0;r=!1;t.addEventListener("mouseout",function(){return clearInterval(r)});return t.addEventListener("mouseover",function(){var t,s;s=1e3/24;t=4;return r=setInterval(function(){var r;r=t*Math.sin(n*Math.PI*s/1e3/2);i.setAttribute("transform","translate(-"+r+")");e.setAttribute("transform","translate("+r+")");return n++},s)})})();