// Generated by CoffeeScript 1.6.3
(function(){var e,t,n,r,i,s,o,u=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=document.querySelector(".board");o=function(){return setTimeout(function(){var e,t,n,r,i;r=[].slice.call(document.getElementsByClassName("js-img"),0);i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.getBoundingClientRect().top<window.innerHeight*2?e.style.backgroundImage?i.push(void 0):i.push(e.style.backgroundImage="url("+e.dataset.src+")"):i.push(void 0)}return i},0)};t.addEventListener("scroll",o);t.addEventListener("touchmove",o);window.addEventListener("resize",o);r=function(){var e,t,n,r,i;r=window.location.hash.substring(1).split("-");i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e&&i.push(e)}return i};s=function(e){return u.call(r(),e)>=0?i(e):n(e)};i=function(e){return window.location.hash=r().filter(function(t){return t!==e}).join("-")};n=function(e){if(u.call(r(),e)<0)return window.location.hash=r().concat(e).sort(function(e,t){return parseInt(e,16)-parseInt(t,16)}).join("-")};window.addEventListener("hashchange",function(){return localStorage.hash=window.location.hash.substring(1)});localStorage["hash"]!=null&&(window.location.hash=localStorage.hash);e=angular.module("aboard",[]);e.filter("mature",function(){return function(e){return u.call(e.split(" "),"mature")>=0?"*":""}});e.controller("main",["$scope","$http","$compile",function(e,s,a){var f;e.feeds=[];e.items=[];e.current=!1;f=s.jsonp("http://spreadsheets.google.com/feeds/list/0AnqTdoRZw_IRdHctX2RyQncwRVA0eWZsSERsdUxOT0E/od6/public/basic?alt=json-in-script&callback=JSON_CALLBACK");f.success(function(t){var i,s,o,a,f,l,c,h,p,d,v,m;s=function(){var e,n,r,s;r=t.feed.entry;s=[];for(e=0,n=r.length;e<n;e++){i=r[e];s.push(JSON.parse('{"id":"'+i.title.$t+'", '+i.content.$t.replace(/([a-z]+)[\s]*\:[\s]*([^,]+)/g,'"$1":"$2"')+"}"))}return s}();s=function(){var e,t,n;n=[];for(e=0,t=s.length;e<t;e++){i=s[e];i.online!=="0"&&n.push(i)}return n}();if(window.location.hash.substring(1))for(a=0,c=s.length;a<c;a++){i=s[a];i.status=(d=i.id,u.call(r(),d)>=0)}else for(f=0,h=s.length;f<h;f++){i=s[f];if(i==null)continue;i.status=i.status==="1"?!0:!1;i.status&&n(i.id)}e.feeds=s;v=r();m=[];for(l=0,p=v.length;l<p;l++){o=v[l];m.push(e.loadItems(o))}return m});e.loadItems=function(t,n){var r,u;n==null&&(n=!1);r=function(){var n,r,i,s;i=e.feeds;s=[];for(n=0,r=i.length;n<r;n++){u=i[n];u.id===t&&s.push(u)}return s}().pop();f=s.jsonp("https://ajax.googleapis.com/ajax/services/feed/load?v=2.0&callback=JSON_CALLBACK&num=100&q="+encodeURIComponent(r.feed));f.error(function(){return i(r.id)});return f.success(function(i){var s,a,f;f=i.responseData.feed.entries;for(s=0,a=f.length;s<a;s++){u=f[s];e.items.push({feed:r.id,source:r.url.replace(/^http(?:s)?\:\/\/([^\/]+)\/*$/,"$1"),title:u.title,author:u.author,date:new Date(u.publishedDate),url:u.link,image:u.content.match(/<img[^<>]+src=[\"\']([^\"\']+)[\"\'][^<>]*>/)[1]})}o();if(n)return e.setCurrent(t)})};e.removeItems=function(t){e.items=e.items.filter(function(e){return e.feed!==t});return e.resetCurrent()};e.resetCurrent=function(){return e.setCurrent(!1)};e.setCurrent=function(n){var r,i,s;if(e.current=n){s=[document.querySelector("#feed-"+n),document.querySelector(".nav-feeds")],r=s[0],i=s[1];i.scrollLeft=r.offsetLeft-i.offsetLeft-i.offsetWidth/2+r.offsetWidth/2}t.scrollTop=0;o();if(!e.$$phase)return e.$apply()};return window.addEventListener("keydown",function(t){var n;switch(t.which){case 37:n=e.current?document.querySelector("#feed-"+e.current).previousSibling:document.querySelector(".nav-feed:last-child");break;case 39:n=e.current?document.querySelector("#feed-"+e.current).nextSibling:document.querySelector(".nav-feed:first-child")}if(n)return n.getAttribute?e.setCurrent(n.getAttribute("id").replace("feed-","")):e.resetCurrent()})}]);e.controller("feed",["$scope","$http",function(e,t){e.showItems=function(){return e.setCurrent(e.feed.id)};return e.toggleFeed=function(){e.feed.status=!e.feed.status;s(e.feed.id);return e.feed.status?e.loadItems(e.feed.id,!0):e.removeItems(e.feed.id)}}]);(function(){var e,t,n,r,i;t=document.getElementById("logo");i=document.getElementById("wave");e=document.getElementById("boat");n=0;r=!1;t.addEventListener("mouseout",function(){return clearInterval(r)});return t.addEventListener("mouseover",function(){var t,s;s=1e3/24;t=4;return r=setInterval(function(){var r;r=t*Math.sin(n*Math.PI*s/1e3/2);i.setAttribute("transform","translate(-"+r+")");e.setAttribute("transform","translate("+r+")");return n++},s)})})()}).call(this);